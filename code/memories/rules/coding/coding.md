---
name: 编码
description: 专业编码专家。规范进行编码，便于调试、维护
---

# 编码规范

## 通用原则

- **保持简单**。尽量选择简单的方法实现功能
- 入口文件: 项目入口文件必须命名为 `index` 或 `main`，避免与其他文件冲突
- 行数限制: 单个代码文件**行数不要超过 500 行**
- 把收到的任务，拆分成可以执行的 Todo list
- 限制每个list 的大小，单一任务限制在 3～5 个可以验证的小问题，如果小问题依然很大，请继续拆解，直至符合要求
- **开发模式**:
    - 完成独立的功能模块后，需要先测试，只有测试通过才开始下一个功能模块的开发。
    - 核心业务逻辑和稳定模块严格遵循**测试驱动开发（TDD）**。
    - 对于一次性脚本、产品原型、技术探索和 UI 布局等，可先编写代码。
    - 避免完全从头开始编码。请请参考成熟的项目，给出技术方案。
- **模块化**:
    - 模块之间减少耦合，尽量单入口和单出口
    - 一次只完成一个功能，使用 markdown 文件作为检查清单和草稿本，减少出错
    - 每个**模块或功能设置单独的文件**，并在文件开头，要详细说明本模块的作用。
    - 遵循 **DRY (Don't Repeat Yourself)** 原则，不重复造轮子。
    - 需要实现的每个功能都需要模块化，方便单独调用
    - 如果模块之间，需要交换状态，设定专门的交换信息的模块
- **界面层和逻辑层**必须分离：代码的藕合，现代前端的设计风格
- **函数设计**:
    - 函数应为**纯函数**：明确的输入/输出，无副作用（不修改输入参数、全局状态等）。
    - 使用**严格类型定义**，所有参数都应明确传递，不使用默认参数值。
    - 优先使用命名参数。
- **日志**
    - 考虑对**关键路径**上的函数，增加日志信息，方便调试。
    - 提供一个全局开关来控制日志的开启和关闭。
    - 每个函数都应增加打印函数名、入参和返回值的日志。
    - 如果有**非传入参数**的变量，也需要打印，避免全局变量的影响
- **异步函数**要慎用，不便于自动化测试
- 支持**热启动**，避免修改代码后，需要手动重启
- 不重复已有代码

## 错误处理

- **明确抛出**: 遇到错误时，立即、明确地抛出，并停止执行。
- **具体错误类型**: 使用能清晰指示问题所在的特定错误类型。
- **可操作信息**: 错误信息应清晰且具有可操作性。
- **记录上下文**: 在抛出错误前，记录包含足够上下文的日志。

## 特定语言指南

### Python

- 使用 `requirements.txt` 文件管理依赖库，方便安装。
- 使用虚拟环境，来运行 Python 脚本

### TypeScript

1.  使用 `pnpm` 安装依赖。
2.  配置 `package.json`（包括 `scripts` 和 `bin`, `type` 等元信息）。
3.  配置 `tsconfig.json`：
    -   启用 `strict` 模式。
    -   将编译产物输出到 `dist` 目录。
4.  运行 `pnpm build` 验证编译是否成功。

## 开发模式

- 对系统的核心业务逻辑和稳定模块严格执行 测试驱动开发的原则
- 对于以下情况，可以先写代码：
    - 一次性脚本。
    - 快速构建产品原型（Proof of Concept）。
    - 探索不确定的技术或算法。
    - UI 布局等视觉相关的开发（虽然现在也有很多针对 UI 的测试框架）。


## UI 设计的原则

- UI 设计要简洁，只显示核心功能，非核心功能通过按钮触发
- CSS 使用 WindCSS，统一管理


## 环境变量配置

- 如果需要设置密码等环境变脸，放在`.env`配置文件中
- 如果`.env`文件不存在，则创建一个`.env.example`

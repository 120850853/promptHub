# 调试

## 核心工作流
当需要调试代码时，你应遵循以下工作流程：

1. **添加日志**。禁止凭感觉，猜问题出在哪里，你应在关键代码路径中添加结构化日志。
2. **定位问题**: 根据日志信息，准确定位到具体的功能模块。定位问题的根本原因，确定问题具体在哪个函数或语句
3. **写测试函数**：单独测试出问题的函数，确定问题的真正原因，同时记录在开发文档，需解释修改的原因和目的。
4. **模块化与最小化变更**:只修改与 Bug 直接相关的代码，避免对其他模块产生不必要的影响。

## 基本原则

- 单循环是可靠性最高的方式
- 一次只解决一个问题，采用目标→方案→日志的单一循环，重复以上过程，直到解决问题

## 结构化日志
- **日志格式**: 日志必须遵循以下 JSON 格式，以便于分析和排查：

```json
{
    "timestamp": "YYYY-MM-DDTHH:mm:ssZ",
    "level": "INFO", 
    "function": "functionName",
    "message": "Descriptive log message",
    "context": {
        "args": "传入参数",
        "return": "返回值",
        "additional": "用于记录辅助信息,比如：在函数内部，引用**非传参**的变量，或者其他有助于找出问题的关键信息等"
    }
}
```

## 日志避免记录什么

- 禁止记录敏感信息：不要把密码、完整信用卡号、隐私数据等

